# üè¶ HELP.MD ‚Äî Spring MVC (Session) Security + PostgreSQL (CustomUserDetailsService)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç: —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ö–µ–º PostgreSQL, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Spring Boot (Session-based, Spring MVC + Spring Security), —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `CustomUserDetailsService` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü `auth.users` –∏ `auth.roles`, –∞ —Ç–∞–∫–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, —à–∞–±–ª–æ–Ω—ã –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ø–∞–Ω–µ–ª–∏ –ø–æ —Ä–æ–ª—è–º (`/client`, `/operator`, `/fraud`, `/admin`).

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. –ö—Ä–∞—Ç–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î
2. SQL: —Å—Ö–µ–º—ã –∏ —Ç–∞–±–ª–∏—Ü—ã (PostgreSQL)
3. Spring Boot: –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
4. Spring Security: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Session-based)
5. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `CustomUserDetailsService`
6. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, Success Handler, —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
7. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ JPA (–ø—Ä–∏–º–µ—Ä—ã)
8. –ü—Ä–∏–º–µ—Ä—ã HTML-—à–∞–±–ª–æ–Ω–æ–≤ (Thymeleaf)
9. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

---

## 1. –ö—Ä–∞—Ç–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î

–°—Ö–µ–º—ã –≤ –æ–¥–Ω–æ–π –±–∞–∑–µ `postgres` (PostgreSQL):
- `auth` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ä–æ–ª–∏
- `profile` ‚Äî –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
- `account` ‚Äî —Å—á–µ—Ç–∞
- `transfer` ‚Äî –ø–µ—Ä–µ–≤–æ–¥—ã
- `anti_fraud` ‚Äî –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è/–∞—É–¥–∏—Ç
- `public_info` ‚Äî –ø—É–±–ª–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–Ω–∫–µ

(–°–º. –ø–æ–ª–Ω—ã–π `init_schemas.sql` –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º –∏ —Ç–∞–±–ª–∏—Ü.)

---

## 2. SQL: —Å—Ö–µ–º—ã –∏ —Ç–∞–±–ª–∏—Ü—ã (–æ—Å–Ω–æ–≤–Ω–æ–µ)

–ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (PostgreSQL):

```sql
-- –ò—Å–ø–æ–ª—å–∑—É–µ–º auth –≤–º–µ—Å—Ç–æ authorization
CREATE SCHEMA IF NOT EXISTS auth;

-- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ö–µ–º
CREATE SCHEMA IF NOT EXISTS profile;
CREATE SCHEMA IF NOT EXISTS account;
CREATE SCHEMA IF NOT EXISTS transfer;
CREATE SCHEMA IF NOT EXISTS anti_fraud;
CREATE SCHEMA IF NOT EXISTS history;
CREATE SCHEMA IF NOT EXISTS public_bank_information;

-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ —Å—Ö–µ–º–µ auth
CREATE TABLE auth.roles (
                            id BIGSERIAL PRIMARY KEY,
                            role_name VARCHAR(255) UNIQUE NOT NULL,
                            description TEXT
);

CREATE TABLE auth.users (
                            id BIGSERIAL PRIMARY KEY,
                            username VARCHAR(255) UNIQUE NOT NULL,
                            password_hash VARCHAR(255) NOT NULL,
                            role_id BIGINT NOT NULL REFERENCES auth.roles(id),
                            profile_id BIGINT,
                            is_enabled BOOLEAN DEFAULT true,
                            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏
INSERT INTO auth.roles (role_name, description) VALUES
                                                    ('client', '–ö–ª–∏–µ–Ω—Ç –±–∞–Ω–∫–∞'),
                                                    ('operator', '–û–ø–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏'),
                                                    ('fraud_analyst', '–ê–Ω–∞–ª–∏—Ç–∏–∫ –∞–Ω—Ç–∏—Ñ—Ä–æ–¥–∞'),
                                                    ('admin', '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä');

-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
INSERT INTO auth.users (username, password_hash, role_id, profile_id, is_enabled) VALUES
    ('admin', '$2a$12$ABC123DEF456GHI789JKL.MNO1PQRST2UVWXYZ3ABCDEF4GHIJKLMNOP', 4, 1, true);

```

> –ü–∞—Ä–æ–ª–∏ –≤ `auth.users.password_hash` –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –∑–∞—Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ (BCrypt).

---

## 3. Spring Boot: –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–í `build.gradle` / `pom.xml` –¥–æ–±–∞–≤—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

**Gradle (fragment)**:
```groovy
implementation 'org.springframework.boot:spring-boot-starter-web'
implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
implementation 'org.springframework.boot:spring-boot-starter-security'
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
runtimeOnly 'org.postgresql:postgresql'
implementation 'org.springframework.boot:spring-boot-starter-validation'
```
–£–±–µ–¥–∏—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å Java 17+ –∏ Spring Boot 3.x.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```
com.example.bankapp
‚îú‚îÄ config         (SecurityConfig, WebMvcConfig)
‚îú‚îÄ controller     (AuthController, DashboardController)
‚îú‚îÄ model          (UserEntity, RoleEntity, AccountEntity –∏ —Ç.–¥.)
‚îú‚îÄ repository     (UserRepository, RoleRepository, AccountRepository)
‚îú‚îÄ service        (CustomUserDetailsService, UserService)
‚îú‚îÄ dto            (LoginDto –∏ —Ç.–ø.)
‚îî‚îÄ templates      (thymeleaf: login.html, client.html, operator.html, fraud.html, admin.html)
```

---

## 4. Spring Security: –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Session-based)

–ü—Ä–∏–º–µ—Ä `SecurityConfig.java` (Spring Boot 3, Java 17):

```java
package com.bank.authorization.config;

import com.bank.authorization.service.CustomUserDetailsService;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.Customizer;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.AuthenticationSuccessHandler;

@Configuration
public class SecurityConfig {

    private final CustomUserDetailsService userDetailsService;
    private final AuthenticationSuccessHandler successHandler;

    public SecurityConfig(CustomUserDetailsService userDetailsService,
                          AuthenticationSuccessHandler successHandler) {
        this.userDetailsService = userDetailsService;
        this.successHandler = successHandler;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .csrf(csrf -> csrf.disable()) // –¥–ª—è —Ñ–æ—Ä–º –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å enabled, –Ω–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è CSRF-—Ç–æ–∫–µ–Ω—ã –≤ —à–∞–±–ª–æ–Ω–∞—Ö
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/login", "/css/**", "/js/**", "/images/**", "/access-denied").permitAll()
                .requestMatchers("/admin/**").hasRole("ADMIN")
                .requestMatchers("/fraud/**").hasAnyRole("FRAUD_ANALYST","ADMIN")
                .requestMatchers("/operator/**").hasAnyRole("OPERATOR","ADMIN")
                .requestMatchers("/client/**").hasAnyRole("CLIENT","ADMIN")
                .anyRequest().authenticated()
            )
            .formLogin(form -> form
                .loginPage("/login")
                .loginProcessingUrl("/perform_login")
                .successHandler(successHandler)
                .failureUrl("/login?error=true")
                .permitAll()
            )
            .logout(logout -> logout
                .logoutUrl("/perform_logout")
                .deleteCookies("JSESSIONID")
                .logoutSuccessUrl("/login?logout=true")
            )
            .userDetailsService(userDetailsService)
        ;
        return http.build();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
```

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: `csrf.disable()` –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã. –í –ø—Ä–æ–¥–∞–∫—à–Ω–µ CSRF –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á—ë–Ω –¥–ª—è —Ñ–æ—Ä–º –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è CSRF-—Ç–æ–∫–µ–Ω—ã –≤ —à–∞–±–ª–æ–Ω–∞—Ö.

---

## 5. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `CustomUserDetailsService`

**UserEntity** (—Å—Ö–µ–º–∞ `auth`):
```java
package com.bank.authorization.model;

import jakarta.persistence.*;

@Entity
@Table(name = "users", schema = "auth")
public class UserEntity {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(unique = true, nullable = false)
    private String username;

    @Column(name = "password_hash", nullable = false)
    private String passwordHash;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "role_id")
    private RoleEntity role;

    @Column(name = "is_enabled")
    private Boolean isEnabled = true;

    // getters/setters
}
```

**RoleEntity**:
```java
package com.bank.authorization.model;

import jakarta.persistence.*;

import java.util.Objects;

@Entity
@Table(name = "roles", schema = "auth")
public class RoleEntity {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(name = "role_name", unique = true, nullable = false)
    private String roleName;
    private String description;

    // getters/setters, equals/hashCode
}
```

**UserRepository**:
```java
package com.bank.authorization.repository;

import com.bank.authorization.model.UserEntity;
import org.springframework.data.jpa.repository.JpaRepository;
import java.util.Optional;

public interface UserRepository extends JpaRepository<UserEntity, Long> {
    Optional<UserEntity> findByUsername(String username);
}
```

**CustomUserDetailsService**:
```java
package com.bank.authorization.service;

import com.bank.authorization.model.UserEntity;
import com.bank.authorization.repository.UserRepository;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;
import org.springframework.security.core.userdetails.UserDetailsService;

import java.util.Collections;

@Service
public class CustomUserDetailsService implements UserDetailsService {

    private final UserRepository userRepository;

    public CustomUserDetailsService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        UserEntity user = userRepository.findByUsername(username)
                .orElseThrow(() -> new UsernameNotFoundException("User not found"));

        GrantedAuthority authority = new SimpleGrantedAuthority("ROLE_" + user.getRole().getRoleName().toUpperCase());

        return org.springframework.security.core.userdetails.User.builder()
                .username(user.getUsername())
                .password(user.getPasswordHash())
                .authorities(authority)
                .disabled(!Boolean.TRUE.equals(user.getIsEnabled()))
                .build();
    }
}
```

---

## 6. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, Success Handler –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

**AuthenticationSuccessHandler** ‚Äî –≤—ã–±–∏—Ä–∞–µ—Ç —Ü–µ–ª—å —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –ø–æ —Ä–æ–ª–∏:

```java
package com.bank.authorization.config;

import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.web.authentication.AuthenticationSuccessHandler;
import org.springframework.stereotype.Component;

import java.io.IOException;

@Component
public class RoleBasedSuccessHandler implements AuthenticationSuccessHandler {

    @Override
    public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,
                                        Authentication authentication) throws IOException, ServletException {

        String redirectUrl = "/";
        for (GrantedAuthority auth : authentication.getAuthorities()) {
            String role = auth.getAuthority();
            if (role.equals("ROLE_ADMIN")) {
                redirectUrl = "/admin";
                break;
            } else if (role.equals("ROLE_FRAUD_ANALYST")) {
                redirectUrl = "/fraud";
                break;
            } else if (role.equals("ROLE_OPERATOR")) {
                redirectUrl = "/operator";
                break;
            } else if (role.equals("ROLE_CLIENT")) {
                redirectUrl = "/client";
                break;
            }
        }
        response.sendRedirect(redirectUrl);
    }
}
```

**AuthController** (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞/–¥–æ—Å—Ç—É–ø–∞):
```java
package com.bank.authorization.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class AuthController {

    @GetMapping("/login")
    public String loginPage() {
        return "login";
    }

    @GetMapping("/access-denied")
    public String accessDenied() {
        return "access-denied";
    }
}
```

**DashboardController** ‚Äî –ø–∞–Ω–µ–ª–∏ –ø–æ —Ä–æ–ª—è–º (–ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã):
```java
package com.bank.authorization.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.ui.Model;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.core.userdetails.User;

@Controller
public class DashboardController {

    @GetMapping("/client")
    public String clientPanel(@AuthenticationPrincipal User user, Model model) {
        model.addAttribute("username", user.getUsername());
        return "client";
    }

    @GetMapping("/operator")
    public String operatorPanel(@AuthenticationPrincipal User user, Model model) {
        model.addAttribute("username", user.getUsername());
        return "operator";
    }

    @GetMapping("/fraud")
    public String fraudPanel(@AuthenticationPrincipal User user, Model model) {
        model.addAttribute("username", user.getUsername());
        return "fraud";
    }

    @GetMapping("/admin")
    public String adminPanel(@AuthenticationPrincipal User user, Model model) {
        model.addAttribute("username", user.getUsername());
        return "admin";
    }
}
```

---

## 7. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ JPA (–ø—Ä–∏–º–µ—Ä—ã)
```java
// RoleRepository
package com.bank.authorization.repository;
import com.bank.authorization.model.RoleEntity;
import org.springframework.data.jpa.repository.JpaRepository;
import java.util.Optional;

public interface RoleRepository extends JpaRepository<RoleEntity, Long> {
    Optional<RoleEntity> findByRoleName(String roleName);
}
```

---

## 8. –ü—Ä–∏–º–µ—Ä—ã HTML-—à–∞–±–ª–æ–Ω–æ–≤ (Thymeleaf)

**templates/login.html**:
```html
<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
</head>
<body>
  <h2>Login</h2>
  <form th:action="@{/perform_login}" method="post">
    <div><label>Username: <input type="text" name="username"/></label></div>
    <div><label>Password: <input type="password" name="password"/></label></div>
    <div><button type="submit">Sign In</button></div>
    <div th:if="${param.error}">Invalid credentials.</div>
    <div th:if="${param.logout}">You have been logged out.</div>
  </form>
</body>
</html>
```

**templates/access-denied.html**:
```html
<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head><meta charset="UTF-8"><title>Access denied</title></head>
<body>
  <h2>Access Denied</h2>
  <p>You do not have permission to access this resource.</p>
  <a th:href="@{/login}">Login</a>
</body>
</html>
```

**templates/client.html** (–ø—Ä–∏–º–µ—Ä):
```html
<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head><meta charset="UTF-8"><title>Client Panel</title></head>
<body>
  <h2>Client Panel</h2>
  <p>Welcome, <span th:text="${username}"></span></p>
  <a th:href="@{/perform_logout}">Logout</a>
</body>
</html>
```

---

## 9. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

- –í—Å–µ–≥–¥–∞ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –≤–∏–¥–µ BCrypt-—Ö—ç—à–∞ (`BCryptPasswordEncoder`).  
- –í –ø—Ä–æ–¥–∞–∫—à–Ω–µ –≤–∫–ª—é—á–∏—Ç–µ CSRF-–∑–∞—â–∏—Ç—É –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CSRF-—Ç–æ–∫–µ–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ö.  
- –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Å—Ö–µ–º–∞–º –∏ —Ç–∞–±–ª–∏—Ü–∞–º —á–µ—Ä–µ–∑ —Å–µ—Ç–µ–≤—ã–µ ACL –∏ RBAC.  
- –õ–æ–≥–∏ –∏ audit: –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ `profile`, `account`, `transfer` –¥–æ–ª–∂–Ω–æ –ø–∏—Å–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ `history` (—Ç—Ä–∏–≥–≥–µ—Ä—ã –∏–ª–∏ application-level logging).  
- –î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis-backed Spring Session.  
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS –∏ HSTS; cookie –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å Secure –∏ HttpOnly.  
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–æ–ª–µ–π: —É–±–µ–¥–∏—Å—å, —á—Ç–æ `ROLE_ADMIN` –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –≤—Å—ë, `ROLE_CLIENT` ‚Äî —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ.

---

## 10. –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ SQL (BCrypt)
```sql
INSERT INTO auth.users (username, password_hash, role_id, profile_id)
VALUES ('ivan.petrov', '$2a$12$...bcrypthash...', 1, NULL);
```

---

## 11. –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ –æ—Ç–ª–∞–¥–∫–∞
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `SELECT id, username, role_id, is_enabled FROM auth.users;`  
- –í–∫–ª—é—á–∏ `logging.level.org.springframework.security=DEBUG` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

¬© 2025 BankingApp Documentation ‚Äî Spring MVC (Session) Edition
